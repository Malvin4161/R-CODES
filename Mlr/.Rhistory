table1 <- table(Drinks,Person)
table1
#*************************************************************************
#Ques 5 Fantaloons Sales managers commented that % of males versus females walking in to the store differ based on day of the week. Analyze the data and determine whether there is evidence at 5 % significance level to support this hypothesis.
fanta<-read.csv("F:\\Study\\DATA_SCIENCE\\Assignment_Mtrl\\Hypothesis_Testing\\Faltoons.csv")
attach(fanta)
table1 <- table(Weekdays,Weekend)
table1
prop.test(x=c(66,47),n=c(233,167),conf.level = 0.95,correct = FALSE,alternative = "two.sided")
prop.test(x=c(66,47),n=c(233,167),conf.level = 0.95,correct = FALSE,alternative = "less")
##***********************************************************************
##Ques 3 Sales of products in four different regions is tabulated for males and females. Find if male-female buyer rations are similar across regions.
Buyers<- read.csv("F:\\Study\\DATA_SCIENCE\\Assignment_Mtrl\\Hypothesis_Testing\\BuyerRatio.csv")
View(Buyers)
View(Buyers)
#Importing required data
BuyerRatio <- read.csv("BuyerRatio.csv")
#Importing required data
BuyerRatio <- read.csv("F:\\Study\\DATA_SCIENCE\\PROJECT_DEMOS\\Assignments_ExcelR_Solutions-master\\Hypothesis testing Assignments\\BuyerRatio.csv")
chisq.test(BuyerRatio[,2:5])
chisq.test(t(BuyerRatio[,2:5]))
#buyers ratio
#the dependent and independent variables are discrete
#chi-square test
a <- read.csv(file.choose())
Buyers2<-Buyers[,-1]
View(Buyers2)
View(Buyers2)
attach(Buyers)
chisq.test(Buyers2)
View(Buyers2)
View(Buyers2)
?chisq
?chisq.test
x <- c(A = 20, B = 15, C = 25)
x
chisq.test(x)
##***********************************************************************
##Ques 3 Sales of products in four different regions is tabulated for males and females. Find if male-female buyer rations are similar across regions.
Buyers<- read.csv("F:\\Study\\DATA_SCIENCE\\Assignment_Mtrl\\Hypothesis_Testing\\BuyerRatio.csv")
Buyers2<-Buyers[,-1]
##***********************************************************************
##Ques 3 Sales of products in four different regions is tabulated for males and females. Find if male-female buyer rations are similar across regions.
Buyers<- read.csv("F:\\Study\\DATA_SCIENCE\\Assignment_Mtrl\\Hypothesis_Testing\\BuyerRatio.csv")
##***********************************************************************
##Ques 3 Sales of products in four different regions is tabulated for males and females. Find if male-female buyer rations are similar across regions.
Buyers<- read.csv("F:\\Study\\DATA_SCIENCE\\Assignment_Mtrl\\Hypothesis_Testing\\BuyerRatio.csv")
View(Buyers)
View(Buyers)
data1<-c(1,2,3,4)
chisq.test(data1)
data1<-c(40,25,19,37,39)
chisq.test(data1)
data2<-c(35,31,38,27,29)
chisq.test(data2)
chisq.test(Buyers2)
##***********************************************************************
##Ques 3 Sales of products in four different regions is tabulated for males and females. Find if male-female buyer rations are similar across regions.
Buyers<- read.csv("F:\\Study\\DATA_SCIENCE\\Assignment_Mtrl\\Hypothesis_Testing\\BuyerRatio.csv")
Buyers2<-Buyers[,-1]
attach(Buyers)
chisq.test(Buyers2)
##****************************************************************************
##Ques 4 TeleCall uses 4 centers around the globe to process customer order forms. They audit a certain %  of the customer order forms. Any error in order form renders it defective and has to be reworked before processing.  The manager wants to check whether the defective %  varies by centre. Please analyze the data at 5% significance level and help the manager draw appropriate inferences
Orders<-read.csv("F:\\Study\\DATA_SCIENCE\\Assignment_Mtrl\\Hypothesis_Testing\\Costomer+OrderForm.csv")
attach(Ordrs)
chisq.test(table(Phillippines,Indonesia,Malta,India))
##****************************************************************************
##Ques 4 TeleCall uses 4 centers around the globe to process customer order forms. They audit a certain %  of the customer order forms. Any error in order form renders it defective and has to be reworked before processing.  The manager wants to check whether the defective %  varies by centre. Please analyze the data at 5% significance level and help the manager draw appropriate inferences
Orders<-read.csv("F:\\Study\\DATA_SCIENCE\\Assignment_Mtrl\\Hypothesis_Testing\\Costomer+OrderForm.csv")
View(Orders)
View(Orders)
# Importing the data set:
CostomerOrderForm = read.csv("Costomer+OrderForm.csv")
# Importing the data set:
CostomerOrderForm = read.csv("F:\\Study\\DATA_SCIENCE\\PROJECT_DEMOS\\Assignments_ExcelR_Solutions-master\\Hypothesis testing Assignments\\Costomer+OrderForm.csv")
View(CostomerOrderForm)
View(CostomerOrderForm)
attach(CostomerOrderForm)
df = as.data.frame(cbind(c(Phillippines,Indonesia,Malta,India),rep(c("Phillippines","Indonesia","Malta","India"),c(300,300,300,300))))
View(df)
View(df)
colnames(df) = c("Type","Location")
head(df)
df_tab1 = table(df$Type,df$Location)
cof<-read_excel(file.choose()) # customer_order(unstacked).xlsx
View(Orders)
View(Orders)
##****************************************************************************
##Ques 4 TeleCall uses 4 centers around the globe to process customer order forms. They audit a certain %  of the customer order forms. Any error in order form renders it defective and has to be reworked before processing.  The manager wants to check whether the defective %  varies by centre. Please analyze the data at 5% significance level and help the manager draw appropriate inferences
Orders<-read.csv("F:\\Study\\DATA_SCIENCE\\Assignment_Mtrl\\Hypothesis_Testing\\Costomer+OrderForm.csv")
View(Orders)
View(Orders)
emp.data <- data.frame(
emp_id = c (1:5),
emp_name = c("Rick","Dan","Michelle","Ryan","Gary"),
salary = c(623.3,515.2,611.0,729.0,843.25),
start_date = as.Date(c("2012-01-01","2013-09-23","2014-11-15","2014-05-11",
"2015-03-27")),
stringsAsFactors = FALSE
)
View(emp.data)
View(emp.data)
View(Orders)
View(Orders)
View(Orders)
View(Orders)
View(Orders)
View(Orders)
View(Orders)
View(Orders)
orders.data<- data.frame(
Country=c(Phillippines,Indonesia,Malta,India),
ErrorType=c(ErrorFree, Defective)
)
attach(Orders)
orders.data<- data.frame(
Country=c(Phillippines,Indonesia,Malta,India),
ErrorType=c(300,300,300,300)
)
View(orders.data)
View(orders.data)
orders.data<- data.frame(cbind(Phillippines,Indonesia,Malta,India),rbind(300,300,300,300)
)
View(orders.data)
View(orders.data)
col1=cbind(Phillippines,Indonesia,Malta
,India)
col1
row=rbind(Phillippines,Indonesia,Malta
,India)
row
col1=rbind(Phillippines,Indonesia,Malta
,India)
col1
col1=rbind(Phillippines,Indonesia,Malta
,India
col1=rbind(Phillippines,Indonesia,Malta
,India)
col1=rbind(Phillippines,Indonesia,Malta,India)
col1
View(col1)
View(col1)
install.packages("Rserve")
library(Rserve)
Rserve
Rserve()
##Predict Price of the computer
compData<- read.csv("F:\\Study\\DATA_SCIENCE\\Assignment_Mtrl\\Mlr\\Computer_Data.csv")
View(compData)
## removing column 1(X)
cmpData<- compData[,-c(1)]
View(cmpData)
## Creating dummy vaiables for discrete data
cmpData$cd<- as.integer(factor(compData$cd,levels=c("yes","no"), labels = c(1,0)))
cmpData$multi<- as.integer(factor(compData$multi,levels = c("yes","no"), labels=c(1,0)))
cmpData$premium<- as.integer(factor(compData$premium, levels = c("yes","no"), labels = c(1,0)))
attach(cmpData)
plot(speed,price)
plot(hd,price)
plot(ram,price)
plot(screen,price)
plot(cd,price)
plot(multi,price)
plot(premium,price)
plot(ads,price)
cor(cmpData)
model1<- lm(price~., data = cmpData)
summary(model1)
model1.s<- lm(price~speed, data = cmpData)
summary(model1.s)
model1.r<- lm(price~ram, data= cmpData)
summary(model1.r)
model1.h<- lm(price~hd, data = cmpData)
summary(model1.h)
model1.sp<- lm(price~speed, data = cmpData)
summary(model1.s)
model1.sc<- lm(price~screen,data = cmpData)
summary(model1.sc)
model1.sc<- lm(price~cd, data = cmpData)
model1.cd<- lm(price~cd, data = cmpData)
summary(model1.cd)
model1.m<- lm(price~multi, data = cmpData)
summary(model1.m)
library(corpcor)
cor(cmpData)
cor2pcor(cor(startups))
cor2pcor(cor(cmpData))
influence.measures(model1)
influenceIndexPlot(model1, id=3)
influenceIndexPlot(model1, id.n=3) # Index Plots of the influence measures
influenceIndexPlot(model1, id.n=3) # Index Plots of the influence measures
##Prepare a prediction model for profit of 50_startups data
startups<- read.csv("F:\\Study\\DATA_SCIENCE\\Assignment_Mtrl\\Mlr\\50_Startups.csv")
getwd()
setwd("F:\\Study\\DATA_SCIENCE\\Assignment_Mtrl\\Mlr")
View(startups)
str(startups)
# crating dummy variable for state
startups$State<- as.integer(factor(startups$State, levels = c('New York','California','Florida'),labels = c(1,2,3)))
View(startups)
attach(startups)
summary(startups)
##EDA
hist(R.D.Spend)
hist(Administration)
hist(Marketing.Spend)
hist(Profit)
hist(State)
qqnorm(R.D.Spend)
qqline(R.D.Spend)
qqnorm(Administration)
qqline(Administration)
qqnorm(Marketing.Spend)
qqline(Marketing.Spend)
plot(R.D.Spend,Profit)
plot(Administration,Profit)
plot(Marketing.Spend,Profit)
plot(State,Profit)
pairs(startups)
#correlation in all variables
cor(startups)
##Regression model1
model1<- lm(Profit~., data = startups)
summary(model1)
model1.RD<- lm(Profit~R.D.Spend)
summary(model1.RD)
model1.Ad<- lm(Profit~Administration)
summary(model1.Ad)
model1.Ms<- lm(Profit~Marketing.Spend)
summary(model1.Ms)
## Check the partial correlation of all variables
panel.cor <- function(x, y, digits=2, prefix="", cex.cor)
{
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r = (cor(x, y))
txt <- format(c(r, 0.123456789), digits=digits)[1]
txt <- paste(prefix, txt, sep="")
if(missing(cex.cor)) cex <- 0.4/strwidth(txt)
text(0.5, 0.5, txt, cex = cex)
}
pairs(startups, upper.panel=panel.cor,main="Scatter Plot Matrix with Correlation Coefficients")
library(corpcor)
cor(startups)
cor2pcor(cor(startups))
plot(model1)
# Deletion Diagnostics for identifying influential variable
influence.measures(model1)
influenceIndexPlot(model1, id.n=3) # Index Plots of the influence measures
influencePlot(model1, id.n=3) # A user friendly representation of the above
influence.measures(model1)
# Deletion Diagnostics for identifying influential variable
library(car)
influence.measures(model1)
influenceIndexPlot(model1, id.n=3) # Index Plots of the influence measures
influence.measures(model1)
-
##Predict Price of the computer
compData<- read.csv("F:\\Study\\DATA_SCIENCE\\Assignment_Mtrl\\Mlr\\Computer_Data.csv")
##Predict Price of the computer
compData<- read.csv("F:\\Study\\DATA_SCIENCE\\Assignment_Mtrl\\Mlr\\Computer_Data.csv")
View(compData)
## removing column 1(X)
cmpData<- compData[,-c(1)]
## Creating dummy vaiables for discrete data
cmpData$cd<- as.integer(factor(compData$cd,levels=c("yes","no"), labels = c(1,0)))
cmpData$multi<- as.integer(factor(compData$multi,levels = c("yes","no"), labels=c(1,0)))
cmpData$premium<- as.integer(factor(compData$premium, levels = c("yes","no"), labels = c(1,0)))
attach(cmpData)
plot(speed,price)
plot(hd,price)
plot(ram,price)
plot(screen,price)
plot(cd,price)
plot(multi,price)
plot(premium,price)
plot(ads,price)
plot(trend,price)
cor(cmpData)
model1<- lm(price~., data = cmpData)
summary(model1)
model1.sp<- lm(price~speed, data = cmpData)
summary(model1.s)
model1.r<- lm(price~ram, data= cmpData)
summary(model1.r)
model1.h<- lm(price~hd, data = cmpData)
summary(model1.h)
model1.sc<- lm(price~screen,data = cmpData)
summary(model1.sc)
model1.cd<- lm(price~cd, data = cmpData)
summary(model1.cd)
model1.m<- lm(price~multi, data = cmpData)
summary(model1.m)
library(corpcor)
cor(cmpData)
cor2pcor(cor(cmpData))
library(car)
influence.measures(model1)
influenceIndexPlot(model1, id.n=3) # Index Plots of the influence measures
influencePlot(model1, id.n=3)
# removing the influencing data points
model1.Final<- lm(price~., data = cmpData[-c(1441,1701),])
summary(model1.Final)
#3prediction model for predicting Price.Corolla
toyota<- read.csv("F:\\Study\\DATA_SCIENCE\\Assignment_Mtrl\\Mlr\\ToyotaCorolla.csv")
View(toyota)
av.plot(model1.Final)
avplot(model1.Final)
library("MASS")
avplot(model1.Final)
library(car)
avplot(model1.Final)
av.plots(model1.Final)
avplots(model1.Final)
avPlots(model1.Final)
##Predict Price of the computer
compData<- read.csv("F:\\Study\\DATA_SCIENCE\\Assignment_Mtrl\\Mlr\\Computer_Data.csv")
## removing column 1(X)
cmpData<- compData[,-c(1)]
## Creating dummy vaiables for discrete data
cmpData$cd<- as.integer(factor(compData$cd,levels=c("yes","no"), labels = c(1,0)))
cmpData$multi<- as.integer(factor(compData$multi,levels = c("yes","no"), labels=c(1,0)))
cmpData$premium<- as.integer(factor(compData$premium, levels = c("yes","no"), labels = c(1,0)))
attach(cmpData)
plot(speed,price)
plot(hd,price)
plot(ram,price)
plot(screen,price)
plot(cd,price)
plot(multi,price)
plot(premium,price)
plot(ads,price)
plot(trend,price)
cor(cmpData)
model1<- lm(price~., data = cmpData)
summary(model1)
model1.sp<- lm(price~speed, data = cmpData)
summary(model1.s)
model1.r<- lm(price~ram, data= cmpData)
summary(model1.r)
model1.h<- lm(price~hd, data = cmpData)
summary(model1.h)
model1.sc<- lm(price~screen,data = cmpData)
summary(model1.sc)
model1.cd<- lm(price~cd, data = cmpData)
summary(model1.cd)
model1.m<- lm(price~multi, data = cmpData)
summary(model1.m)
library(corpcor)
cor(cmpData)
cor2pcor(cor(cmpData))
library(car)
influence.measures(model1)
influenceIndexPlot(model1, id.n=3) # Index Plots of the influence measures
influencePlot(model1, id.n=3)
# removing the influencing data points
model1.Final<- lm(price~., data = cmpData[-c(1441,1701),])
summary(model1.Final)
library("MASS")
avPlots(model1.Final)
plot(toyota)
#3prediction model for predicting Price.Corolla
toyota<- read.csv("F:\\Study\\DATA_SCIENCE\\Assignment_Mtrl\\Mlr\\ToyotaCorolla.csv")
View(toyota)
plot(toyota)
cor(toyota)
toyota<- as.data.frame(toyota[,-c(1)])
View(toyota)
plot(toyota)
cor(toyota)
#3prediction model for predicting Price.Corolla
toyota<- read.csv("F:\\Study\\DATA_SCIENCE\\Assignment_Mtrl\\Mlr\\ToyotaCorolla.csv")
#3prediction model for predicting Price.Corolla
toyota<- read.csv("F:\\Study\\DATA_SCIENCE\\Assignment_Mtrl\\Mlr\\ToyotaCorolla.csv")
View(toyota)
toyota<- as.data.frame(toyota[,-c(1)])
View(toyota)
plot(toyota)
cor(toyota)
summary(toyota)
cor(toyota)
View(toyota)
#3prediction model for predicting Price.Corolla
toyota<- read.csv("F:\\Study\\DATA_SCIENCE\\Assignment_Mtrl\\Mlr\\ToyotaCorolla.csv")
View(toyota)
corolla<- toyota[c("Price","Age_08_04","KM","HP","cc","Doors","Gears","Quarterly_Tax","Weight")]
View(toyota)
View(corolla)
summary(corolla)
cor(corolla)
pairs(corolla)
cor2pcor(corolla)
cor2pcor(cor(corolla))
## Builing regression model on corolla data set
model1<- lm(corolla~., data= corolla)
## Builing regression model on corolla data set
model1<- lm(price ~ ., data= corolla)
## Builing regression model on corolla data set
model1<- lm(price ~ ., data= corolla, ata = corolla, drop.unused.levels = FALSE)
## Builing regression model on corolla data set
model1<- lm(price ~ ., data= corolla, data = corolla, drop.unused.levels = FALSE)
## Builing regression model on corolla data set
model1<- lm(price ~ ., data= corolla)
## Builing regression model on corolla data set
model1<- lm(price ~., data= corolla)
## Builing regression model on corolla data set
model1<- lm(Price ~., data= corolla)
summary(model1)
model1$coefficients
model1$residuals
rmse1<- sqrt(sum(model1$residuals^2)/nrow(Price))
attach(corolla)
rmse1<- sqrt(sum(model1$residuals^2)/nrow(Price))
rmse1
rmse1<-mean(model1$residuals^2)^.5
rmse1
pred1<- predict(model1, corolla)
cor(pred1, corolla$Price)
cor(pred1$fit, corolla$Price)  ## r - 0.9293
pred1<- predict(model1, interval = "predict")
cor(pred1$fit, corolla$Price)  ## r - 0.9293
pred1
pred1<- predict(model1, corolla)
pred1
cor(pred1$fit, corolla$Price)  ## r - 0.9293
cor(pred1, corolla$Price)  ## r - 0.9293
avPlots(model1)
## Checking the influenctial data
influence.measures(model1)
influenceIndexPlot(model1, id=3)
influenceIndexPlot(model1, id.n=3)
influencePlot(model1, id.n=3)
model2<- lm(Price~., data = corolla[-c(81,961,222)],)
summary(model2)
rmse2<- mean(model2$residuals^2)^.5
rmse2
pred2<- predict(model2, corolla)
cor(pred2, corolla$Price)
influence_index <- as.integer(rownames(influencePlot(model1)))
## Building model by removing influential datas
corolla2<- corolla[-c(influence_index)]
model2<- lm(Price~., data = corolla2)
summary(model2)  ## R square value = 0.8638   , so no difference yet
## Building model by removing influential datas
corolla2<- corolla[-c(influence_index),]
model2<- lm(Price~., data = corolla2)
summary(model2)  ## R square value = 0.8638   , so no difference yet
rmse2<- mean(model2$residuals^2)^.5
rmse2    ## rmse value 1338.258
pred2<- predict(model2, corolla2)
cor(pred2, corolla2$Price)
claimants = read.csv("F:\\Study\\DATA_SCIENCE\\Data_Science_Sessions_Vinod\\claimants.csv")
summary(claimants)
View(claimants)
View(claimants)
claimants = read.csv("F:\\Study\\DATA_SCIENCE\\Data_Science_Sessions_Vinod\\claimants.csv")
summary(claimants)
?str
str(claimants)
summary(claimants)
attach(claimants)
claimants$ATTORNEY =as.factor(claimants$ATTORNEY)
claimants2 = na.omit(claimants)
summary(claimants2)
library(dummies)
dummies = dummy(claimants$CLMINSUR , sep = "_")
dummies
View(dummies)
# Imputation
library(Hmisc)
claimants$CLMAGE <- with(claimants, impute(claimants$CLMAGE, mean))
summary(claimants)
logit=glm(ATTORNEY ~ factor(CLMSEX) + factor(CLMINSUR) + factor(SEATBELT)
+ CLMAGE + LOSS,family= "binomial",data=claimants)
?glm
summary(logit)
prob=predict(logit,type=c("response"),claimants)
prob
confusion<-table(prob>0.5,claimants$ATTORNEY)
confusion
Accuracy<-sum(diag(confusion))/sum(confusion)
Accuracy
pred_values  = NULL
yes_NO = NULL
for (i in 1:1340){
pred_values[i] = ifelse(prob[i]>= 0.5,1,0)
yes_NO[i] = ifelse(prob[i]>= 0.5,'Yes',"no")
}
claimants[,"prob"] = prob
claimants[,"pred_values"] = pred_values
claimants[,"yes_NO"] = yes_NO
# ROC Curve
library(ROCR)
rocrpred<-prediction(prob,claimants$ATTORNEY)
rocrperf<-performance(rocrpred,'tpr','fpr')
plot(rocrperf,colorize=T)
##Whether the client has subscribed a term deposit or not Binomial ("yes" or "no")
Bank_Data<- read.csv("F:\\Study\\DATA_SCIENCE\\Assignment_Mtrl\\Logistic_Regression\\bank-full.csv")
View(Bank_Data)
##Whether the client has subscribed a term deposit or not Binomial ("yes" or "no")
Bank_Data<- read.csv("F:\\Study\\DATA_SCIENCE\\Assignment_Mtrl\\Logistic_Regression\\bank-full.csv")
View(Bank_Data)
##Whether the client has subscribed a term deposit or not Binomial ("yes" or "no")
Bank_Data<- read.csv("F:\\Study\\DATA_SCIENCE\\Assignment_Mtrl\\Logistic_Regression\\bank-full.csv")
View(Bank_Data)
BankData %>% seperate(Bank_Data,c("Age","job","marital", "education", "default", "balance", "housing","loan","contact","day","month","duration","campaign","pdays","previous","poutcome","y"))
BankData<- seperate(Bank_Data,c("Age","job","marital", "education", "default", "balance", "housing","loan","contact","day","month","duration","campaign","pdays","previous","poutcome","y"))
BankData<- separate(Bank_Data,c("Age","job","marital", "education", "default", "balance", "housing","loan","contact","day","month","duration","campaign","pdays","previous","poutcome","y"))
install.packages("dplyr")
library(dplyr)
install.packages("dplyr")
